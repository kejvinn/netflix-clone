@if (singleService.showModal()) {
  <div class="single">
    <div class="backdrop" (click)="singleService.close()"></div>
    @if (singleService.media(); as single) {
      @defer {
        <div class="modal">
          <div class="modal-content">
            <button class="close" (click)="singleService.close()">
              <ng-icon name="heroXMark"></ng-icon>
            </button>
            <app-overview
              [backdrop]="single.backdrop_path | tmdbImage: 'original'"
              [logo]="single.logo_url | tmdbImage: 'original'"
              [alt]="single | mediaTitle"
              [tagline]="single.tagline"
            ></app-overview>
            <app-details
              [releaseDate]="single | releaseDateFormat"
              [runtime]="single | runtimeFormat"
              [rating]="single.adult ? '16+' : 'E'"
              [cast]="single.cast"
              [genres]="single.genres"
              [overview]="single.overview"
            ></app-details>

            <div class="recommendations">
              @for (
                rec of single.recommendations | slice: 0 : 15;
                track rec.id
              ) {
                @defer {
                  <app-recommendation
                    (click)="openInfo(rec)"
                    [backdrop]="rec.backdrop_path | tmdbImage: 'w500'"
                    [logo]="rec.logo_url | tmdbImage: 'w200'"
                    [alt]="rec | mediaTitle"
                    [releaseDate]="rec | releaseDateFormat"
                    [voteAverage]="rec.vote_average.toPrecision(2)"
                    [rating]="rec.adult ? '+16' : 'E'"
                    [overview]="rec.overview"
                    (info)="openInfo($event)"
                  ></app-recommendation>
                }
              }
            </div>
            <app-credits
              [title]="single | mediaTitle"
              [cast]="single.cast"
              [genres]="single.genres"
            ></app-credits>
          </div>
        </div>
      }
    } @else {
      <div class="modal-placeholder">
        <img src="assets/gif/loading.gif" alt="placeholder" />
      </div>
    }
  </div>
}
